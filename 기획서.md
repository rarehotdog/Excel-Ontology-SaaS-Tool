# Excel Ontology Platform 기획서

## 문제 정의

기업의 데이터 담당자와 재무팀은 매일 수십 개의 엑셀 파일을 다루며 데이터 변환과 대사 작업에 많은 시간을 소비한다. 이들은 복잡한 수식 작성, 반복적인 피벗 테이블 생성, 다중 파일 간 데이터 검증을 수작업으로 처리하며, 단순 실수로 인한 오류가 빈번하게 발생한다.

## 페인포인트

엑셀 데이터 변환 작업에서 사용자는 원하는 결과를 얻기 위해 VLOOKUP, 피벗 테이블, 조건부 필터링 등 여러 함수와 기능을 조합해야 한다. 이 과정에서 수식 오류, 참조 범위 실수, 데이터 타입 불일치 문제가 반복적으로 발생한다. 정산 업무에서는 운임 데이터, 카드 결제 내역, 빌링 데이터 등 다중 소스를 수작업으로 대조하며, 불일치 항목을 찾는 데 평균 2~3시간이 소요된다. A/B 파일 비교 시에는 행 단위로 눈으로 확인하거나 별도의 비교 수식을 작성해야 하며, 대용량 파일의 경우 엑셀 자체의 성능 한계로 작업이 중단되기도 한다. 또한 작업 과정이 기록되지 않아 동일한 변환 로직을 매번 다시 구성해야 하는 비효율이 존재한다.

## 솔루션

Excel Ontology Platform은 자연어 명령으로 데이터 변환 파이프라인을 자동 생성하는 Smart Transform 기능과 다중 파일 대사를 처리하는 Settlement 기능을 제공한다. 사용자가 "상태별로 그룹화하고 각 그룹의 평균 예산을 계산해줘"라고 입력하면, 백엔드의 SmartTransformer가 프롬프트를 파싱하여 Filter, GroupBy, Calculate 노드로 구성된 파이프라인을 자동 생성한다. 프론트엔드는 React와 ReactFlow를 사용하여 생성된 파이프라인을 시각적으로 표시하고, 사용자가 드래그 앤 드롭으로 노드를 추가하거나 수정할 수 있다. Settlement 기능은 무결성 검증 모드와 비교 분석 모드를 제공하며, 업로드된 파일 목록에서 A/B 파일을 선택하여 키 매핑 후 대사를 실행한다. 백엔드는 FastAPI와 Pandas로 구현되어 `/data/upload`, `/data/list`, `/smart-transform/generate` 엔드포인트를 통해 파일 처리와 변환 로직을 수행한다.

## 솔루션의 기대 효과

자연어 입력 방식으로 엑셀 수식 작성 시간을 단축한다. 파이프라인 시각화를 통해 데이터 변환 로직을 한눈에 파악할 수 있어 검토 시간이 감소한다. 파일 업로드 후 즉시 메타데이터(행 수, 열 수, 컬럼명)가 표시되어 데이터 구조 파악이 즉각적으로 가능하다. Settlement의 A/B 비교 모드에서 양쪽 파일의 컬럼을 미리보기로 확인하고 매핑할 수 있어 키 설정 오류가 감소한다. 생성된 변환 결과는 CSV 형식으로 즉시 다운로드가 가능하며, 별도의 후처리 없이 바로 활용할 수 있다. 6단계 워크플로우(파일 선택 → 키 매핑 → 규칙 설정 → 실행 → 드릴다운 → 리포트)를 통해 정산 작업의 진행 상황을 명확하게 추적한다.

## AI의 역할

SmartTransformer 클래스는 사용자의 자연어 프롬프트를 분석하여 데이터 변환 계획을 생성한다. `generate_plan_from_prompt()` 메서드는 입력된 프롬프트에서 "그룹", "필터", "정렬" 등의 키워드를 추출하고, 해당하는 변환 연산(GROUP_BY, FILTER, ORDER_BY)을 파이프라인 노드로 매핑한다. 생성된 계획은 nodes 배열과 connections 배열로 구성되어 프론트엔드의 ReactFlow 캔버스에 즉시 렌더링된다. 프롬프트에 "그룹"이 포함되면 부서별 집계 데이터(count, total_budget, avg_util)가 previewData로 반환되고, "필터"가 포함되면 조건에 맞는 샘플 행이 반환된다. `/smart-transform/generate` 엔드포인트는 POST 요청으로 `{ "prompt": "자연어 명령" }` 형식의 JSON을 받아 `{ "nodes": [...], "connections": [...], "previewData": [...] }` 형식으로 응답한다. 현재 구현은 키워드 기반 매칭 방식이며, 향후 LLM API 연동을 통해 복잡한 자연어 해석으로 확장 가능한 구조로 설계되어 있다.




